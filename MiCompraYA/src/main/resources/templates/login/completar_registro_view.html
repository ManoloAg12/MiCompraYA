<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiCompraYa - Completar Registro</title>
  <link rel="icon" type="image/png" href="/images/canasta.png">

  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#2ECC71',
            secondary: '#27AE60'
          },
          fontFamily: {
            'pacifico': ['Pacifico', 'serif'],
            'inter': ['Inter', 'sans-serif']
          }
        }
      }
    }
  </script>

  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">

  <style>
    body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #f8fffe 0%, #e8f8f5 100%); min-height: 100vh; }
    .auth-container { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); box-shadow: 0 20px 40px rgba(46, 204, 113, 0.1); }
    .form-input { transition: all 0.3s ease; border: 2px solid #e1e5e9; }
    .form-input:focus { border-color: #2ECC71; box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.1); transform: translateY(-2px); }
    .btn-primary { background: linear-gradient(135deg, #2ECC71, #27AE60); transition: all 0.3s ease; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(46, 204, 113, 0.3); }
    .animate-fade-in { animation: fadeIn 0.6s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

<div class="auth-container w-full max-w-md rounded-2xl p-8">

  <div class="text-center mb-8">
    <div class="flex items-center justify-center mb-4">
      <div class="w-12 h-12 flex items-center justify-center bg-green-600 rounded-xl mr-3">
        <i class="ri-user-follow-line text-white text-xl"></i>
      </div>
      <h1 class="font-pacifico text-3xl text-gray-800">¡Casi listo!</h1>
    </div>
    <p class="text-gray-600 text-sm animate-fade-in">
      Hola <span class="font-bold text-primary" th:text="${session.temp_google_nombre}">Usuario</span>, necesitamos unos datos extra para tus pedidos.
    </p>
  </div>

  <form class="space-y-5" th:action="@{/registrar-google}" method="post">

    <div>
      <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Tu Correo (Google)</label>
      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><i class="ri-google-fill text-gray-400"></i></div>
        <input type="email" disabled
               th:value="${session.temp_google_email}"
               class="form-input w-full pl-10 pr-4 py-2 rounded-lg border-gray-200 bg-gray-50 text-gray-500 text-sm cursor-not-allowed">
      </div>
    </div>

    <div>
      <label for="telefono" class="block text-sm font-medium text-gray-700 mb-2">Teléfono <span class="text-red-500">*</span></label>
      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><i class="ri-phone-line text-gray-400"></i></div>
        <input type="text" name="telefono" id="telefono"
               class="form-input w-full pl-10 pr-4 py-3 rounded-lg border-none outline-none text-sm"
               placeholder="Ej: 7777-8888" inputmode="numeric" maxlength="9" required autofocus>
      </div>
    </div>

    <div>
      <label for="direccion" class="block text-sm font-medium text-gray-700 mb-2">Dirección <span class="text-red-500">*</span></label>
      <div class="relative">
        <div class="absolute top-3 left-0 pl-3 flex items-start pointer-events-none"><i class="ri-map-pin-line text-gray-400"></i></div>
        <textarea name="direccion" id="direccion" rows="3"
                  class="form-input w-full pl-10 pr-4 py-3 rounded-lg border-none outline-none text-sm resize-none"
                  placeholder="Ej: Colonia Escalon, Calle Principal #123..." required></textarea>
      </div>
    </div>

    <button type="submit" class="btn-primary w-full py-3 px-6 rounded-lg text-white font-medium mt-4 !rounded-button whitespace-nowrap hover:animate-pulse">
      Finalizar Registro
    </button>

    <div class="text-center mt-4">
      <a th:href="@{/login}" class="text-sm text-gray-400 hover:text-gray-600 transition-colors">Cancelar</a>
    </div>

  </form>
</div>

<script>
  document.getElementById('telefono').addEventListener('input', function (e) {
    var x = e.target.value.replace(/\D/g, '').match(/(\d{0,4})(\d{0,4})/);
    e.target.value = !x[2] ? x[1] : x[1] + '-' + x[2];
  });
</script>

</body>
</html>